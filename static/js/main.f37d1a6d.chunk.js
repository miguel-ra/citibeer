(this.webpackJsonpcitibeer=this.webpackJsonpcitibeer||[]).push([[0],{12:function(e,t,n){e.exports={wrapper:"BeerDetail_wrapper__3_OmN",figure:"BeerDetail_figure__3prpT",content:"BeerDetail_content__1G_yR",details:"BeerDetail_details__2NoR0",date:"BeerDetail_date__ldQjl",name:"BeerDetail_name__U5oQE",tagline:"BeerDetail_tagline__2J8ZG",description:"BeerDetail_description__fR0z9",actions:"BeerDetail_actions__3N9ea"}},14:function(e,t,n){e.exports={container:"BeersList_container__2Fwje",beer:"BeersList_beer__2MmIq",figure:"BeersList_figure__1mk-B",details:"BeersList_details__1Qetv",date:"BeersList_date__3WuQy",name:"BeersList_name__1uLCz",tagline:"BeersList_tagline__JwZ6P"}},146:function(e,t,n){},147:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(45),c=n.n(i),s=n(63),o=n.n(s),l=n(148),u=n(64),b=n(4),d=n(0),f={openModal:function(){},closeModal:function(){}},j=a.a.lazy((function(){return n.e(3).then(n.bind(null,152))})),v=a.a.createContext(f);function h(){var e=Object(r.useContext)(v);if(!e)throw new Error("useModal must be used within the ModalContext");return e}function O(e){var t=e.children,n=Object(r.useRef)(null),a=Object(r.useState)(),i=Object(b.a)(a,2),c=i[0],s=i[1],o=Object(r.useCallback)((function(e){n.current=document.activeElement,document.body.classList.add("preventScroll"),s(e)}),[]),l=Object(r.useCallback)((function(){var e;document.body.classList.remove("preventScroll"),s(void 0),null===(e=n.current)||void 0===e||e.focus(),n.current=null}),[]);return Object(d.jsxs)(v.Provider,{value:{openModal:o,closeModal:l},children:[Object(d.jsx)(r.Suspense,{fallback:null,children:Object(d.jsx)(j,{containerId:"root-modal",closeModal:l,children:c})}),t]})}var m={queries:{refetchOnWindowFocus:!1}};var p=function(e){var t=e.children,n=e.options,r=new l.a({defaultOptions:o()(m,null===n||void 0===n?void 0:n.queryClient)});return Object(d.jsx)(u.a,{client:r,children:Object(d.jsx)(O,{children:t})})};var g=function(e,t,n){var a=Object(r.useState)(e),i=Object(b.a)(a,2),c=i[0],s=i[1];Object(r.useEffect)((function(){e&&e!==c&&s(e)}),[e]),Object(r.useEffect)((function(){if(c&&c.addEventListener){var e=function(e){n(e)};return c.addEventListener(t,e),function(){c.removeEventListener(t,e)}}}),[c,n,t])},x=n(6),_=n(9),w=n(18),y=n(37),N=n.n(y);var F=function(e){var t=e.label,n=e.name,a=e.checked,i=e.className,c=e.onChange,s=Object(_.a)(e,["label","name","checked","className","onChange"]),o=Object(r.useState)(a||!1),l=Object(b.a)(o,2),u=l[0],f=l[1];return Object(r.useEffect)((function(){a!==u&&f(a||!1)}),[a]),Object(d.jsxs)("div",{className:N.a.wrapper,children:[Object(d.jsx)("input",Object(x.a)({id:n,name:n,type:"checkbox",checked:c?u:void 0,onChange:c?function(e){var t=e.target.checked;f(t),null===c||void 0===c||c(t)}:void 0,className:Object(w.a)(N.a.input,i)},s)),Object(d.jsx)("label",{htmlFor:n,className:N.a.label,children:t})]})},k=n(65),S=n(38),C=n.n(S);var B=function(e){var t=e.label,n=e.name,a=e.value,i=e.pattern,c=e.className,s=e.onChange,o=Object(_.a)(e,["label","name","value","pattern","className","onChange"]),l=Object(r.useState)(a||""),u=Object(b.a)(l,2),f=u[0],j=u[1];Object(r.useEffect)((function(){a!==f&&j(a||"")}),[a]);var v=Object(r.useCallback)(Object(k.debounce)((function(e){return null===s||void 0===s?void 0:s(e)}),300),[]),h=Object(r.useCallback)((function(e){var t=e.target.value;if(i&&!new RegExp(i).test(t))return;j(t),v(t)}),[v,i]);return Object(d.jsxs)("div",{className:C.a.wrapper,children:[Object(d.jsx)("label",{htmlFor:n,className:C.a.label,children:t}),Object(d.jsx)("input",Object(x.a)({id:n,name:n,value:s||i?f:void 0,onChange:s||i?h:void 0,className:Object(w.a)(C.a.input,c)},o))]})},E=n(70),L=n(11),I=n.n(L),M=n(23),D=n(19),z=n(35),P=function(){function e(){Object(D.a)(this,e),this.serialize=void 0,this.deserialize=void 0,this.storageKey=void 0,this.storageKey="favoriteBeers",this.serialize=JSON.stringify,this.deserialize=JSON.parse}return Object(z.a)(e,[{key:"getLocalStorageItem",value:function(){var e=window.localStorage.getItem(this.storageKey),t=[];return e&&(t=this.deserialize(e)),t}},{key:"setLocalStorageItem",value:function(e){window.localStorage.setItem(this.storageKey,this.serialize(e))}},{key:"getAll",value:function(){var e=Object(M.a)(I.a.mark((function e(){var t,n=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.length>0&&void 0!==n[0]?n[0]:{},t=this.getLocalStorageItem(),e.abrupt("return",t.reverse()||[]);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Object(M.a)(I.a.mark((function e(t){var n,r,a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getLocalStorageItem(),r=n.filter((function(e){return e.id!==t.id})),a=[].concat(Object(E.a)(r),[t]),this.setLocalStorageItem(a),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(M.a)(I.a.mark((function e(t){var n,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getLocalStorageItem(),r=n.filter((function(e){return e.id!==t})),this.setLocalStorageItem(r),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),A=new P,R={filters:{},setFilters:function(){},favoriteIds:[],addFavorite:function(){},removeFavorite:function(){}},J=Object(r.createContext)(R);function q(){var e=Object(r.useContext)(J);if(!e)throw new Error("useBeers must be used within the BeersContext");return e}function T(e){var t=e.children,n=Object(r.useState)(R.filters),a=Object(b.a)(n,2),i=a[0],c=a[1],s=Object(r.useState)(R.favoriteIds),o=Object(b.a)(s,2),l=o[0],u=o[1];Object(r.useEffect)((function(){A.getAll().then((function(e){var t=e.map((function(e){return e.id}));t.length&&u(t)}))}),[]);var f=Object(r.useCallback)((function(e){A.add(e).then((function(e){return u(e.map((function(e){return e.id})))}))}),[]),j=Object(r.useCallback)((function(e){A.remove(e).then((function(e){return u(e.map((function(e){return e.id})))}))}),[]);return Object(d.jsx)(J.Provider,{value:{filters:i,setFilters:c,favoriteIds:l,addFavorite:f,removeFavorite:j},children:t})}var Y=n(66),K=n.n(Y);var U=function(){var e,t=q(),n=t.filters,r=t.setFilters;return Object(d.jsxs)("form",{className:K.a.wrapper,children:[Object(d.jsx)(B,{label:"Name",name:"beerName",onChange:function(e){r((function(t){return Object(x.a)(Object(x.a)({},t),{},{beerName:e})}))},value:n.beerName}),Object(d.jsx)(B,{label:"First brewed",name:"firstBrewed",type:"month",placeholder:"YYYY-MM",pattern:/^(\d{0,4}(-(0[1-9]{0,1}|1[0-2]{0,1})?)?)?$/,onChange:function(e){e&&4!==e.length&&!e.includes("-")||r((function(t){return Object(x.a)(Object(x.a)({},t),{},{firstBrewed:e.split("-").reverse().join("-")})}))},value:null===(e=n.firstBrewed)||void 0===e?void 0:e.split("-").reverse().join("-")}),Object(d.jsx)(F,{label:"Show only favorite beers",name:"showFavorites",onChange:function(e){r((function(t){return Object(x.a)(Object(x.a)({},t),{},{showFavorites:e})}))},checked:n.showFavorites})]})},Q=n(149),G=n(67),Z=n(71),W=n(72),H=function(e){Object(G.a)(n,e);var t=Object(Z.a)(n);function n(){var e;return Object(D.a)(this,n),(e=t.call(this)).name="BeersInvalidData",e.message="Invalid params",e}return n}(Object(W.a)(Error)),V="https://api.punkapi.com/v2";function X(e){if(!e)return{};if(!e.includes("-")){var t=parseInt(e,10);return{brewed_after:"12-".concat(t-1),brewed_before:"01-".concat(t+1)}}var n=e.split("-").map(Number),r=Object(b.a)(n,2),a=r[0],i=r[1],c=new Date(i,a),s=new Date(i,a);return c.setMonth(c.getMonth()-2),{brewed_after:"".concat(c.getMonth()+1,"-").concat(c.getFullYear()),brewed_before:"".concat(s.getMonth()+1,"-").concat(s.getFullYear())}}var $=function(){function e(){Object(D.a)(this,e)}return Object(z.a)(e,[{key:"getAll",value:function(){var e=Object(M.a)(I.a.mark((function e(){var t,n,r,a,i,c,s,o,l,u=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},n=t.beerName,r=t.firstBrewed,a=Object(_.a)(t,["beerName","firstBrewed"]),i=Object(x.a)(Object(x.a)({beer_name:n},X(r)),a),c=Object.entries(i).filter((function(e){var t=Object(b.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(b.a)(e,2);return[t[0],t[1].toString()]})),s=new URLSearchParams(c).toString(),e.next=6,fetch("".concat(V,"/beers?").concat(s));case 6:if((o=e.sent).ok){e.next=9;break}throw new H;case 9:return e.next=11,o.json();case 11:return l=e.sent,e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ee={showFavorites:!1};var te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=e.showFavorites,n=Object(r.useState)(new $),a=Object(b.a)(n,2),i=a[0],c=a[1];return Object(r.useEffect)((function(){return c(t?new P:new $)}),[t]),i};var ne=function(e,t){var n=Object(r.useState)(null),a=Object(b.a)(n,2),i=a[0],c=a[1];return Object(r.useEffect)((function(){if(i){var n=new IntersectionObserver((function(t){t[0].isIntersecting&&e()}),t);return n.observe(i),function(){n.unobserve(i)}}}),[e,i,t]),{ref:c}};function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var ie=r.createElement("path",{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"});function ce(e,t){var n=e.title,a=e.titleId,i=ae(e,["title","titleId"]);return r.createElement("svg",re({"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,ie)}var se=r.forwardRef(ce),oe=(n.p,n(68)),le=n.n(oe);function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{delay:250},t=e.visible,n=e.delay,a=arguments.length>1?arguments[1]:void 0,i=Object(r.useState)(t),c=Object(b.a)(i,2),s=c[0],o=c[1];return Object(r.useEffect)((function(){if(!s){var e=setTimeout((function(){o(!0)}),250);return function(){clearTimeout(e)}}}),[n,s]),s?Object(d.jsx)(se,{ref:a,role:"alert","aria-busy":"true","aria-label":"spinner","aria-hidden":"false",className:le.a.spinner}):null}var be=Object(r.forwardRef)(ue),de=n.p+"static/media/barrel.0dcab2ca.svg",fe=[{range:[-1,3],emoji:"\ud83d\ude42",label:"Alcohol by volume less than or equal to 3%"},{range:[3,8],emoji:"\ud83d\ude0a",label:"Alcohol by volume less than or equal to 8% but greater than 3%"},{range:[8,15],emoji:"\ud83e\udd74",label:"Alcohol by volume less than or equal to 15% but greater than 8%"},{range:[15,1/0],emoji:"\ud83e\udd22",label:"Alcohol by volume greater than 15%"}];var je=function(e){var t=e.abv,n=void 0===t?0:t,r=fe.find((function(e){var t=e.range;return n>t[0]&&n<=t[1]}))||fe[0];return Object(d.jsx)("span",{role:"img","aria-label":r.label,title:r.label,children:r.emoji})},ve=n(14),he=n.n(ve);function Oe(e){if(!e.includes("/"))return e;var t=e.split("/").map(Number),n=Object(b.a)(t,2),r=n[0],a=n[1];return new Date(a,r-1).toLocaleString("en-GB",{month:"long",year:"numeric"})}var me=function(e){var t=e.data,n=e.onShowDetails;return Object(d.jsx)("section",{className:he.a.container,children:null===t||void 0===t?void 0:t.map((function(e){return Object(d.jsxs)("article",{className:he.a.beer,tabIndex:0,onClick:function(){return n(e)},onKeyDown:function(t){"Enter"===t.key&&n(e)},children:[Object(d.jsxs)("figure",{className:he.a.figure,children:[Object(d.jsx)("img",{src:e.image_url||de,alt:e.name}),Object(d.jsx)("figcaption",{children:Object(d.jsx)(je,{abv:e.abv})})]}),Object(d.jsxs)("div",{className:he.a.details,children:[Object(d.jsx)("div",{className:he.a.date,children:Oe(e.first_brewed)}),Object(d.jsx)("h4",{className:he.a.name,children:e.name}),Object(d.jsx)("p",{className:he.a.tagline,children:e.tagline})]})]},e.id)}))})},pe=n(69),ge=n.n(pe);var xe=function(e){var t=e.className,n=e.children,r=Object(_.a)(e,["className","children"]);return Object(d.jsx)("button",Object(x.a)(Object(x.a)({className:Object(w.a)(ge.a.button,t)},r),{},{children:n}))},_e=n(12),we=n.n(_e);var ye=function(e){var t=e.beer,n=e.isFavorite,a=e.addFavorite,i=e.removeFavorite,c=h().closeModal,s=Object(r.useState)(n),o=Object(b.a)(s,2),l=o[0],u=o[1];return Object(d.jsxs)("div",{className:we.a.wrapper,children:[Object(d.jsxs)("figure",{className:we.a.figure,children:[Object(d.jsx)("img",{src:t.image_url||de,alt:t.name}),Object(d.jsx)("figcaption",{children:Object(d.jsx)(je,{abv:t.abv})})]}),Object(d.jsxs)("div",{className:we.a.content,children:[Object(d.jsx)("div",{className:we.a.date,children:t.first_brewed}),Object(d.jsx)("h4",{className:we.a.name,children:t.name}),Object(d.jsxs)("div",{className:we.a.details,children:[Object(d.jsx)("p",{className:we.a.tagline,children:t.tagline}),Object(d.jsx)("p",{className:we.a.description,children:t.description})]}),Object(d.jsxs)("div",{className:we.a.actions,children:[!l&&Object(d.jsx)(xe,{onClick:function(){a(t),u(!0)},children:"Agregar"}),l&&Object(d.jsx)(xe,{onClick:function(){i(t.id),u(!1)},children:"Eliminar"}),Object(d.jsx)(xe,{onClick:function(){return c()},children:"Cerrar"})]})]})]})},Ne={root:null,rootMargin:"300px",threshold:0};var Fe=function(){var e=Object(r.useState)([]),t=Object(b.a)(e,2),n=t[0],a=t[1],i=q(),c=i.favoriteIds,s=i.addFavorite,o=i.removeFavorite,l=i.filters,u=l.showFavorites,f=Object(_.a)(l,["showFavorites"]),j=te({showFavorites:u}),v=h().openModal,O=Object(Q.a)(["beers",JSON.stringify(f),c.length,j],(function(e){var t=e.pageParam,n=void 0===t?{per_page:24,page:1}:t;return j.getAll(Object(x.a)(Object(x.a)({},n),f))}),{getNextPageParam:function(e,t){if(!(0===e.length))return{per_page:24,page:t.length+1}}}),m=O.data,p=O.isLoading,g=O.isError,w=O.hasNextPage,y=O.fetchNextPage,N=ne(y,Ne).ref,F=Object(r.useCallback)((function(e){v(Object(d.jsx)(ye,{beer:e,isFavorite:c.includes(e.id),addFavorite:s,removeFavorite:o}))}),[s,c,v,o]),k=null===m||void 0===m?void 0:m.pages[m.pages.length-1];return Object(r.useEffect)((function(){if(!p){var e=(null===m||void 0===m?void 0:m.pages)?m.pages.flat():[];a(e)}}),[m,p]),p&&!n.length?Object(d.jsx)(be,{}):g?Object(d.jsx)("p",{children:"Failed to get data"}):n.length?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(me,{data:n,onShowDetails:F}),w&&24===(null===k||void 0===k?void 0:k.length)&&Object(d.jsx)(be,{ref:N,visible:!0})]}):Object(d.jsx)("p",{children:"No data to display"})};var ke=function(){return Object(d.jsxs)(T,{children:[Object(d.jsx)(U,{}),Object(d.jsx)(Fe,{})]})},Se=n(44),Ce=n.n(Se);var Be=function(){return Object(r.useEffect)((function(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")}),[]),g(window,"mousedown",(function(){document.body.classList.add("mousedown")})),g(window,"keydown",(function(){document.body.classList.remove("mousedown")})),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("header",{className:Ce.a.header,children:Object(d.jsx)("h1",{children:"Citibeer"})}),Object(d.jsx)("main",{className:Ce.a.main,children:Object(d.jsx)(ke,{})})]})},Ee=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,151)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))};n(146);c.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(p,{children:Object(d.jsx)(Be,{})})}),document.getElementById("root")),Ee()},37:function(e,t,n){e.exports={wrapper:"CheckboxField_wrapper__aDI60",label:"CheckboxField_label__367UV",input:"CheckboxField_input__24-wU"}},38:function(e,t,n){e.exports={wrapper:"Field_wrapper__3nZ82",label:"Field_label__enDEX",input:"Field_input__21rsF"}},44:function(e,t,n){e.exports={header:"App_header__1ULvh",main:"App_main__1n4oc"}},66:function(e,t,n){e.exports={wrapper:"BeersFilters_wrapper__4MuTx"}},68:function(e,t,n){e.exports={spinner:"Spinner_spinner__kptye",spin:"Spinner_spin__gDMJH"}},69:function(e,t,n){e.exports={button:"Button_button__Nfhxt"}}},[[147,1,2]]]);
//# sourceMappingURL=main.f37d1a6d.chunk.js.map